{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\MSI GF63\\\\Desktop\\\\ShoppingWeb\\\\frontend\\\\src\\\\service\\\\Guard.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React from \"react\";\nimport { Navigate, useLocation } from \"react-router-dom\";\nimport ApiService from \"./ApiService\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const ProtectedRoute = ({\n  element: Component\n}) => {\n  _s();\n  const location = useLocation();\n  const [isChecking, setIsChecking] = useState(true);\n  useEffect(() => {\n    const checkAuth = async () => {\n      try {\n        if (!ApiService.isAuthenticated()) {\n          throw new Error('Not authenticated');\n        }\n        // Thử verify token với backend\n        await ApiService.verifyToken();\n        setIsChecking(false);\n      } catch (error) {\n        ApiService.logout();\n        navigate('/login', {\n          state: {\n            from: location\n          },\n          replace: true\n        });\n      }\n    };\n    checkAuth();\n  }, [location]);\n  if (isChecking) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Checking authentication...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 16\n    }, this);\n  }\n  return ApiService.isAuthenticated() ? Component : /*#__PURE__*/_jsxDEV(Navigate, {\n    to: \"/login\",\n    replace: true,\n    state: {\n      from: location\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 38,\n    columnNumber: 9\n  }, this);\n};\n_s(ProtectedRoute, \"gmNcwgC4HrjRCZJaL3VufBO7Vag=\", false, function () {\n  return [useLocation];\n});\n_c = ProtectedRoute;\nexport const AdminRoute = ({\n  element: Component\n}) => {\n  _s2();\n  const location = useLocation();\n  return ApiService.isAdmin() ? Component : /*#__PURE__*/_jsxDEV(Navigate, {\n    to: \"/login\",\n    replace: true,\n    state: {\n      from: location\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 9\n  }, this);\n};\n_s2(AdminRoute, \"pkHmaVRPskBaU4tMJuJJpV42k1I=\", false, function () {\n  return [useLocation];\n});\n_c2 = AdminRoute;\nvar _c, _c2;\n$RefreshReg$(_c, \"ProtectedRoute\");\n$RefreshReg$(_c2, \"AdminRoute\");","map":{"version":3,"names":["React","Navigate","useLocation","ApiService","jsxDEV","_jsxDEV","ProtectedRoute","element","Component","_s","location","isChecking","setIsChecking","useState","useEffect","checkAuth","isAuthenticated","Error","verifyToken","error","logout","navigate","state","from","replace","children","fileName","_jsxFileName","lineNumber","columnNumber","to","_c","AdminRoute","_s2","isAdmin","_c2","$RefreshReg$"],"sources":["C:/Users/MSI GF63/Desktop/ShoppingWeb/frontend/src/service/Guard.js"],"sourcesContent":["import React from \"react\";\r\nimport { Navigate, useLocation } from \"react-router-dom\";\r\nimport ApiService from \"./ApiService\";\r\n\r\n\r\nexport const ProtectedRoute = ({element: Component}) => {\r\n    const location = useLocation();\r\n    const [isChecking, setIsChecking] = useState(true);\r\n    \r\n    useEffect(() => {\r\n        const checkAuth = async () => {\r\n            try {\r\n                if (!ApiService.isAuthenticated()) {\r\n                    throw new Error('Not authenticated');\r\n                }\r\n                // Thử verify token với backend\r\n                await ApiService.verifyToken();\r\n                setIsChecking(false);\r\n            } catch (error) {\r\n                ApiService.logout();\r\n                navigate('/login', { \r\n                    state: { from: location },\r\n                    replace: true \r\n                });\r\n            }\r\n        };\r\n        \r\n        checkAuth();\r\n    }, [location]);\r\n\r\n    if (isChecking) {\r\n        return <div>Checking authentication...</div>;\r\n    }\r\n\r\n    return ApiService.isAuthenticated() ? (\r\n        Component\r\n    ) : (\r\n        <Navigate to=\"/login\" replace state={{from: location}}/>\r\n    );\r\n};\r\n\r\n\r\nexport const AdminRoute = ({element: Component}) => {\r\n    const location = useLocation();\r\n\r\n    return ApiService.isAdmin() ? (\r\n        Component\r\n    ):(\r\n        <Navigate to=\"/login\" replace state={{from: location}}/>\r\n    );\r\n};\r\n"],"mappings":";;;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,QAAQ,EAAEC,WAAW,QAAQ,kBAAkB;AACxD,OAAOC,UAAU,MAAM,cAAc;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAGtC,OAAO,MAAMC,cAAc,GAAGA,CAAC;EAACC,OAAO,EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EACpD,MAAMC,QAAQ,GAAGR,WAAW,CAAC,CAAC;EAC9B,MAAM,CAACS,UAAU,EAAEC,aAAa,CAAC,GAAGC,QAAQ,CAAC,IAAI,CAAC;EAElDC,SAAS,CAAC,MAAM;IACZ,MAAMC,SAAS,GAAG,MAAAA,CAAA,KAAY;MAC1B,IAAI;QACA,IAAI,CAACZ,UAAU,CAACa,eAAe,CAAC,CAAC,EAAE;UAC/B,MAAM,IAAIC,KAAK,CAAC,mBAAmB,CAAC;QACxC;QACA;QACA,MAAMd,UAAU,CAACe,WAAW,CAAC,CAAC;QAC9BN,aAAa,CAAC,KAAK,CAAC;MACxB,CAAC,CAAC,OAAOO,KAAK,EAAE;QACZhB,UAAU,CAACiB,MAAM,CAAC,CAAC;QACnBC,QAAQ,CAAC,QAAQ,EAAE;UACfC,KAAK,EAAE;YAAEC,IAAI,EAAEb;UAAS,CAAC;UACzBc,OAAO,EAAE;QACb,CAAC,CAAC;MACN;IACJ,CAAC;IAEDT,SAAS,CAAC,CAAC;EACf,CAAC,EAAE,CAACL,QAAQ,CAAC,CAAC;EAEd,IAAIC,UAAU,EAAE;IACZ,oBAAON,OAAA;MAAAoB,QAAA,EAAK;IAA0B;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;EAChD;EAEA,OAAO1B,UAAU,CAACa,eAAe,CAAC,CAAC,GAC/BR,SAAS,gBAETH,OAAA,CAACJ,QAAQ;IAAC6B,EAAE,EAAC,QAAQ;IAACN,OAAO;IAACF,KAAK,EAAE;MAACC,IAAI,EAAEb;IAAQ;EAAE;IAAAgB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAC,CAC1D;AACL,CAAC;AAACpB,EAAA,CAlCWH,cAAc;EAAA,QACNJ,WAAW;AAAA;AAAA6B,EAAA,GADnBzB,cAAc;AAqC3B,OAAO,MAAM0B,UAAU,GAAGA,CAAC;EAACzB,OAAO,EAAEC;AAAS,CAAC,KAAK;EAAAyB,GAAA;EAChD,MAAMvB,QAAQ,GAAGR,WAAW,CAAC,CAAC;EAE9B,OAAOC,UAAU,CAAC+B,OAAO,CAAC,CAAC,GACvB1B,SAAS,gBAETH,OAAA,CAACJ,QAAQ;IAAC6B,EAAE,EAAC,QAAQ;IAACN,OAAO;IAACF,KAAK,EAAE;MAACC,IAAI,EAAEb;IAAQ;EAAE;IAAAgB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAC,CAC1D;AACL,CAAC;AAACI,GAAA,CARWD,UAAU;EAAA,QACF9B,WAAW;AAAA;AAAAiC,GAAA,GADnBH,UAAU;AAAA,IAAAD,EAAA,EAAAI,GAAA;AAAAC,YAAA,CAAAL,EAAA;AAAAK,YAAA,CAAAD,GAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}